$(document).ready(function(o){o.bubbler=function(t,n){var i=this,r=o(t),a=o(window);i.el=t;var e,l,s=r.width(),u=r.height();r.data("bubbler",i),i.init=function(){i.options=o.extend({},o.bubbler.defaultOptions,n),r.css({background:this.options.color,overflow:"hidden",position:"fixed"}),e=s>u?Math.floor(u*i.options.max):Math.floor(s*i.options.max),l=s>u?Math.floor(u*i.options.min):Math.floor(s*i.options.min);for(var t=0;t<this.options.ammount;t++){var p;p=o("<bubble></bubble>");var m=Math.floor(Math.random()*e+l),M=2*Math.random()|0?c(i.options.color,3*Math.random()+2):c(i.options.color,-1*(3*Math.random()+2)),v=b(m),M=o.extend({display:"block",position:"absolute",width:m,height:m,background:M,left:v[0],top:v[1]},f(i.options.style,m,M));p.css(M),p.size=m,r.append(p),d(p)}a.bind("resize",h())};var h=function(){s=r.width(),u=r.height(),e=s>u?Math.floor(u*i.options.max):Math.floor(s*i.options.max),l=s>u?Math.floor(u*i.options.min):Math.floor(s*i.options.min)},f=function(o){switch(o){case"circle":return{"border-radius":"50%"};default:return{}}},c=function(o,t){var n=parseInt(o.slice(1),16),i=Math.round(2.55*t),r=(n>>16)+i,a=(n>>8&255)+i,n=(255&n)+i;return"#"+(16777216+65536*(255>r?1>r?0:r:255)+256*(255>a?1>a?0:a:255)+(255>n?1>n?0:n:255)).toString(16).slice(1)},b=function(o){var t=Math.floor(Math.random()*(s+o))-o;return o=Math.floor(Math.random()*(u+o))-o,[t,o]},d=function(o){var t=b(o.size),n=o.offset(),r={},a={x:n.left,y:n.top},n={x:n.left,y:n.top};i.options.horizontal&&(r.left=t[0],n.x=t[0]),i.options.vertical&&(r.top=t[1],n.y=t[1]),o.animate(r,m(p(a,n)),function(){d(o)})},p=function(o,t){var n=0,i=0,n=t.x-o.x,i=t.y-o.y;return Math.sqrt(n*n+i*i)},m=function(o){return 1e3*i.options.time/(s>u?s:u)*o};i.init()},o.bubbler.defaultOptions={color:"#555555",ammount:20,min:.1,max:.4,time:60,vertical:!0,horizontal:!0,style:"circle"},o.fn.bubbler=function(t){return this.each(function(){new o.bubbler(this,t)})}});